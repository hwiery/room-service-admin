# ABC 숙소 예약 서비스 서비스 백오피스 상세 SOW - 3. 예약 관리

## 3.1. 예약 내역 관리

### 🔹 3.1.1. 전체 예약 목록 조회

*   **화면 정보:**
    *   타이틀: 예약 목록 관리
    *   설명: 서비스 내에서 발생한 모든 예약 내역을 조회하고 검색/필터링하는 화면
*   **기능 목적:** 전체 예약 현황 파악, 특정 예약 검색 및 상세 조회 페이지 진입 제공
*   **구성 요소:**
    *   **검색/필터 영역:**
        *   예약 번호(ID) 입력 필드
        *   예약자 정보 입력 필드 (이름, 휴대폰 번호, 이메일, 회원 ID)
        *   숙소명/숙소 ID 입력 필드
        *   객실명/객실 ID 입력 필드
        *   예약 상태 선택 드롭다운 (예약완료, 이용완료, 예약취소, 취소요청, 결제실패 등 다중 선택 가능)
        *   결제 수단 선택 드롭다운 (신용카드, 가상계좌 등)
        *   체크인/체크아웃 날짜 기간 선택 (달력 UI)
        *   예약일/결제일/취소일 기간 선택 (달력 UI)
        *   검색 버튼, 초기화 버튼
    *   **목록 테이블 영역:**
        *   예약 번호 (클릭 시 상세 조회 페이지 이동)
        *   예약 상태 (뱃지 또는 텍스트 표시)
        *   숙소명
        *   객실명
        *   체크인 날짜 / 체크아웃 날짜
        *   예약자명 / 회원 여부
        *   결제 금액 (원화)
        *   결제 수단
        *   예약 일시
        *   (필요시) 관리 버튼 (상세 보기)
    *   **기능 버튼 영역:**
        *   (선택적) 엑셀 다운로드 버튼
    *   **페이지네이션:** 목록 하단 페이지 이동 컴포넌트
*   **상태:**
    *   기본: 목록 조회 상태 (기본 정렬: 예약일 내림차순)
    *   검색/필터링: 조건 입력 및 결과 반영 상태
*   **운영자 인터랙션:**
    *   검색 조건 입력 및 검색 버튼 클릭
    *   목록 테이블 컬럼 헤더 클릭 시 정렬
    *   예약 번호 또는 관리(상세 보기) 버튼 클릭 시 상세 조회 페이지(3.1.2)로 이동
    *   페이지네이션 클릭
*   **결과 액션:**
    *   검색/필터링 조건에 맞는 예약 목록 출력
    *   상세 보기 클릭 시 해당 예약의 상세 정보 페이지 로드
*   **예외 처리:**
    *   검색 결과 없을 시 "검색 결과가 없습니다." 메시지 출력
    *   잘못된 검색 조건 입력 시 알림 (예: 날짜 형식 오류)

### 🔹 3.1.2. 예약 상세 조회

*   **화면 정보:**
    *   타이틀: 예약 상세 정보 ([예약번호])
    *   설명: 특정 예약 건에 대한 모든 상세 정보를 확인하는 화면 (수정 기능은 최소화)
*   **기능 목적:** 개별 예약 건의 상세 내역 확인 및 CS 응대 지원
*   **구성 요소 (섹션 구분):**
    *   **예약 기본 정보:**
        *   예약 번호, 예약 상태
        *   예약 일시, 수정 일시(있을 경우)
    *   **숙소/객실 정보:**
        *   숙소명 (링크 제공 시 숙소 상세 관리 페이지 이동)
        *   객실명 (링크 제공 시 객실 상세 관리 페이지 이동)
        *   체크인 / 체크아웃 날짜 및 시간
        *   숙박 기간 (N박 M일)
        *   인원 (성인 N명, 아동 N명)
    *   **예약자 정보:**
        *   이름, 휴대폰 번호, 이메일 주소
        *   회원 여부, 회원 ID (회원인 경우 회원 상세 페이지 링크 제공)
    *   **결제 정보 (3.2.2 결제 상세 정보 연동):**
        *   결제 상태, 결제 수단
        *   총 객실 가격
        *   적용된 할인 내역 (프로모션)
        *   최종 결제 금액 
        *   결제 일시
        *   PG사 거래 ID 
    *   **취소/환불 정보 (취소된 경우, 3.3 연동):**
        *   취소 요청/완료 일시
        *   취소 사유
        *   적용된 취소 규정명
        *   취소 수수료 
        *   환불 상태, 환불 예정/완료 금액
        *   환불 처리 일시 (완료 시)
    *   **(선택적) 예약 변경 이력:** 상태 변경, 정보 수정 등 이력 표시
    *   **상단/하단 버튼 영역:**
        *   목록으로 버튼 (3.1.1 페이지 이동)
        *   (제한적) 예약 상태 변경 버튼 (3.1.3 기능, 특정 조건 하에 노출)
        *   (필요시) 관련 결제 내역 보기 버튼 (3.2.2 페이지 이동)
        *   (필요시) 관련 환불 내역 보기 버튼 (3.3 페이지 이동)
*   **상태:** 읽기 전용 (Readonly) 상태가 기본
*   **운영자 인터랙션:**
    *   정보 확인 및 스크롤
    *   링크 클릭 (숙소/객실/회원 정보 이동)
    *   목록으로 버튼 클릭
    *   (제한적) 상태 변경 버튼 클릭
*   **결과 액션:**
    *   예약과 관련된 모든 상세 정보 제공
    *   목록으로 버튼 클릭 시 예약 목록 페이지로 이동
    *   상태 변경 액션 수행 (3.1.3 참조)
*   **예외 처리:**
    *   존재하지 않는 예약 번호 접근 시 "예약 정보를 찾을 수 없습니다." 알림
    *   데이터 로딩 실패 시 에러 메시지

### 🔹 3.1.3. (필요시) 예약 상태 변경

*   **화면 정보:** (예약 상세 조회 화면 내 기능 또는 별도 관리 기능)
    *   타이틀: 예약 상태 변경
    *   설명: 운영자가 특정 사유로 예약 상태를 수동 변경하는 기능 (매우 제한적으로 사용)
*   **기능 목적:** 시스템 오류, 외부 요인 등으로 발생한 예약 상태 불일치 해결 또는 특정 운영 정책 수행
*   **구성 요소 (예약 상세 조회 내 버튼 클릭 시 모달 형태):**
    *   현재 예약 상태 표시
    *   변경할 예약 상태 선택 드롭다운 (변경 가능한 상태만 노출, 예: '결제실패' -> '예약완료', '예약완료' -> '관리자취소')
    *   상태 변경 사유 입력 필드 (필수, 상세 기록)
    *   확인/취소 버튼
*   **상태:** 상태 선택 및 사유 입력 대기
*   **운영자 인터랙션:**
    *   변경할 상태 선택
    *   변경 사유 상세 입력
    *   확인 버튼 클릭 (2차 확인 절차 포함 가능)
*   **결과 액션:**
    *   확인 시 DB에 예약 상태 업데이트 및 사유 기록.
    *   연관된 시스템 로직 트리거 가능성 (예: 재고 조정, 알림 발송 - 주의 필요!).
    *   예약 상세 및 목록 화면에 변경된 상태 반영.
    *   성공/실패 알림 메시지 출력.
*   **예외 처리:**
    *   변경 불가능한 상태로의 변경 시도 차단.
    *   변경 사유 미입력 시 저장 불가.
    *   상태 변경 로직 실패 시 롤백 처리 및 에러 알림.
    *   **중요:** 권한이 있는 관리자만 접근 가능하도록 엄격한 권한 관리 필요. 모든 변경 이력은 상세 로그로 기록되어야 함.

---

## 3.2. 결제 내역 관리

### 🔹 3.2.1. 전체 결제 목록 조회

*   **화면 정보:**
    *   타이틀: 결제 내역 관리
    *   설명: 모든 결제 시도 및 완료 내역을 조회하고 검색/필터링하는 화면
*   **기능 목적:** 결제 성공/실패 현황 파악, 특정 결제 건 추적 및 상세 조회 진입
*   **구성 요소:**
    *   **검색/필터 영역:**
        *   결제 ID 입력 필드
        *   예약 번호 입력 필드
        *   예약자 정보 입력 필드 (이름, 회원 ID 등)
        *   결제 상태 선택 드롭다운 (성공, 실패, 취소, 진행중 등)
        *   결제 수단 선택 드롭다운 (신용카드, 가상계좌 등)
        *   결제 요청일/완료일 기간 선택 (달력 UI)
        *   PG사 거래 ID 
        *   검색 버튼, 초기화 버튼
    *   **목록 테이블 영역:**
        *   결제 ID (클릭 시 상세 조회 페이지 이동)
        *   예약 번호 (링크 제공 시 예약 상세 이동)
        *   결제 상태 (뱃지 또는 텍스트)
        *   결제 수단
        *   결제 금액 
        *   예약자명
        *   결제 요청 일시
        *   결제 완료/실패/취소 일시
        *   (필요시) 관리 버튼 (상세 보기)
    *   **기능 버튼 영역:**
        *   (선택적) 엑셀 다운로드 버튼
    *   **페이지네이션:** 목록 하단 페이지 이동 컴포넌트
*   **상태:** 목록 조회, 검색/필터링 상태
*   **운영자 인터랙션:** 검색 조건 입력 및 검색, 정렬, 결제 ID 클릭, 페이지 이동
*   **결과 액션:** 조건에 맞는 결제 목록 출력, 상세 보기 클릭 시 상세 정보 페이지(3.2.2) 로드
*   **예외 처리:** 검색 결과 없음 메시지, 잘못된 검색 조건 알림

### 🔹 3.2.2. 결제 상세 조회

*   **화면 정보:**
    *   타이틀: 결제 상세 정보 ([결제 ID])
    *   설명: 특정 결제 건의 상세 정보 및 관련 이력을 확인하는 화면
*   **기능 목적:** 개별 결제 건의 상세 내역 확인, 문제 발생 시 원인 파악 지원
*   **구성 요소 (섹션 구분):**
    *   **결제 기본 정보:**
        *   결제 ID, 결제 상태
        *   결제 요청/완료/실패/취소 일시
    *   **예약 정보:**
        *   예약 번호 (링크 제공 시 예약 상세 이동)
        *   숙소명, 객실명
        *   예약자명
    *   **결제 상세 내역:**
        *   결제 수단 상세 (카드사, 카드번호 일부, 은행명 등)
        *   요청 금액 
        *   할인 내역 (결제 시점 기준)
        *   최종 결제(시도) 금액
        *   (PG) PG사 승인 번호, 거래 ID
    *   **결제 이력:** (상태 변경, 실패 사유 등 로그 표시)
    *   **상단/하단 버튼 영역:**
        *   목록으로 버튼 (3.2.1 페이지 이동)
        *   (필요시) 관련 예약 보기 버튼 (3.1.2 페이지 이동)
*   **상태:** 읽기 전용 (Readonly)
*   **운영자 인터랙션:** 정보 확인, 링크 클릭, 목록으로 버튼 클릭
*   **결과 액션:** 결제 관련 상세 정보 제공, 목록으로 버튼 클릭 시 결제 목록 페이지로 이동
*   **예외 처리:** 존재하지 않는 결제 ID 접근 시 오류 알림, 데이터 로딩 실패 시 에러 메시지

---

## 3.3. 취소/환불 관리

### 🔹 3.3.1. 취소 요청/완료 목록 조회

*   **화면 정보:**
    *   타이틀: 예약 취소 내역 관리
    *   설명: 예약 취소(요청 포함) 건들의 목록을 조회하고 검색/필터링하는 화면
*   **기능 목적:** 예약 취소 현황 파악, 특정 취소 건 추적 및 상세 확인
*   **구성 요소:**
    *   **검색/필터 영역:**
        *   취소 ID (있을 경우) 또는 예약 번호 입력 필드
        *   예약자 정보 입력 필드
        *   숙소명 입력 필드
        *   취소 상태 선택 드롭다운 (취소요청, 취소완료, 취소실패, 환불처리중, 환불완료 등)
        *   취소 요청일/완료일 기간 선택 (달력 UI)
        *   검색 버튼, 초기화 버튼
    *   **목록 테이블 영역:**
        *   예약 번호 (클릭 시 예약 상세 이동)
        *   취소 상태 (뱃지 또는 텍스트)
        *   숙소명
        *   체크인 날짜
        *   예약자명
        *   취소 요청 일시
        *   취소 완료 일시
        *   취소 수수료
        *   환불 예정/완료 금액
        *   환불 상태 (뱃지 또는 텍스트)
        *   (필요시) 관리 버튼 (상세 보기 - 예약 상세 또는 환불 상세로 연결)
    *   **기능 버튼 영역:**
        *   (선택적) 엑셀 다운로드 버튼
    *   **페이지네이션:** 목록 하단 페이지 이동 컴포넌트
*   **상태:** 목록 조회, 검색/필터링 상태
*   **운영자 인터랙션:** 검색 조건 입력 및 검색, 정렬, 예약 번호 클릭, 페이지 이동
*   **결과 액션:** 조건에 맞는 예약 취소 목록 출력, 상세 보기 클릭 시 관련 상세 정보 페이지 로드
*   **예외 처리:** 검색 결과 없음 메시지, 잘못된 검색 조건 알림

### 🔹 3.3.2. 환불 처리 현황 관리

*   **화면 정보:** (취소 목록 내 통합 표시 또는 별도 메뉴 가능)
    *   타이틀: 환불 처리 관리
    *   설명: 예약 취소에 따른 환불 처리 상태를 모니터링하고, 필요시 수동 개입하는 화면
*   **기능 목적:** 환불 프로세스 추적 및 관리, 환불 실패 건 처리
*   **구성 요소:**
    *   **환불 목록 테이블 (취소 목록과 유사하나 환불 정보에 집중):**
        *   환불 ID (있을 경우) 또는 예약 번호
        *   환불 상태 (요청, 처리중, 완료, 실패, 보류 등)
        *   예약자명
        *   환불 수단 (신용카드 등 원래 결제 수단)
        *   환불 요청 금액 
        *   취소 수수료 
        *   최종 환불 금액 
        *   환불 요청 일시
        *   환불 처리(완료/실패) 일시
        *   (실패 시) 실패 사유
        *   관리 버튼 (상세 보기, 재처리 시도, 수동 완료 처리 등 - 제한적 기능)
    *   **검색/필터:** 환불 상태, 환불 수단, 날짜 등으로 필터링
    *   **(수동 처리 기능 - 모달 등):**
        *   선택한 환불 건에 대해 '수동 완료' 처리 기능 (내부 확인 후 상태 변경)
        *   '재처리 시도' 기능 (자동 환불 시스템 연동 시)
        *   처리 사유/메모 입력
*   **상태:** 목록 조회, 필터링, 수동 처리 대기/진행 중
*   **운영자 인터랙션:** 목록 조회 및 필터링, 특정 환불 건 선택 및 상세 확인, (제한적) 수동 완료 처리 또는 재처리 시도 버튼 클릭 및 사유 입력
*   **결과 액션:** 환불 처리 현황 파악. 수동 처리 시 DB에 환불 상태 업데이트 및 사유 기록. 재처리 시도 시 자동 환불 시스템에 요청 전달. 성공/실패 알림.
*   **예외 처리:** 환불 상태 업데이트 실패 시 롤백 및 에러 알림. 권한 없는 관리자의 처리 시도 차단. 모든 처리 내역 로그 기록 필수. 자동 환불 시스템 연동 오류 시 명확한 알림 및 수동 처리 가이드 필요.
